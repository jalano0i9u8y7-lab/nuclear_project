# 架構師級 SSOT 檢查清單 V8

**目的**：每次改動 SSOT 或實作後，供工程師逐條過濾，找出「未來會爆炸的點」——不是找 bug，而是找邏輯錯誤、系統打架、重複工作、無用工作、I/O 遺失、接口錯誤、無限迴圈、結構錯位、系統無法收斂等風險。

**使用時機**：完成任一 Phase / 模組 / 資料流 / Prompt / 規則變動後，依序勾選本清單。

---

## 一、架構層檢查清單（Structure Integrity）

防的是：**模組職權污染**。

| # | 檢查項 | 自檢問句 | 通過標準 |
|---|--------|----------|----------|
| **1** | **Phase 職責唯一性** | 這個功能是否同時存在兩個 Phase？刪掉其中一個，系統還會正常嗎？哪一個才是真正的 Source of Truth？ | 一個功能只能有一個「最終決定者」 |
| **2** | **上游覆寫下游風險** | P5/WB 的結論是否可能反向改寫 P2/P3？Snapshot 是否被「重新計算」而不是「引用」？ | 遵守 One-Way Locking；下游只引用、不重算上游 |
| **3** | **模組邊界模糊度** | 這個函數/改動會影響幾個 Phase？ | 若超過 2 個 Phase，代表耦合過高，需拆解或明文化介面 |

---

## 二、邏輯層檢查清單（Logic Conflict）

防的是：**規則打架與重複判斷**。

| # | 檢查項 | 自檢問句 | 通過標準 |
|---|--------|----------|----------|
| **4** | **同一決策是否被多次計算** | Regime 在 P5 判一次、P3 又判一次？Risk Overlay 在 P4 和 P5 都重新算？ | 決策「生成一次，多處引用」 |
| **5** | **衝突優先權是否可見** | 當兩條規則衝突，誰贏？工程師能否一眼看到順序？ | 有明文化優先權表（如 Market Climate Override > P4 > P5 > Individual） |
| **6** | **隱性寫死** | 是否出現「必須、永遠、一律、禁止」等字眼？若不在風控層，是否應改為「強烈建議 + 例外說明」？ | 風控層可寫死；其餘應可例外且需說明理由 |

---

## 三、資料流檢查清單（Data Flow）

防的是：**重算、遺失、污染**。

| # | 檢查項 | 自檢問句 | 通過標準 |
|---|--------|----------|----------|
| **7** | **是否重複抓資料** | 同一 API 是否被三個 Phase 打？能否集中快取？ | 同一數據源集中取得，下游從快取/DB 讀 |
| **8** | **資料來源一致性** | 同一指標在不同 Phase 是否用不同來源？單位或時間粒度是否一致？ | 同一指標單一來源、單位與粒度一致 |
| **9** | **Snapshot 真正有被用嗎** | 下游是否「引用」Snapshot，還是每次都重算？ | 下游引用 Snapshot / Delta Pack，不重算上游結論 |

---

## 四、AI 決策層檢查清單（AI Freedom vs Constraint）

防的是：**AI 被規則掐死**。

| # | 檢查項 | 自檢問句 | 通過標準 |
|---|--------|----------|----------|
| **10** | **Prompt 是否存在「自由區」** | 每個決策 Prompt 是否具備：HARD CONSTRAINT（數學/風控）、GUIDELINES（經驗/結構）、FREE REASONING（AI 自主）？ | 三層都有；若只有 1+2 沒有 3 → AI 會變成計算機 |
| **11** | **是否允許例外** | 每條規則是否允許違反？若違反，是否要求「說明理由」？ | 高階設計：允許，但必須自我解釋 |
| **12** | **是否有「不決策」出口** | AI 能否輸出 DATA_INSUFFICIENT、NEED_MORE_CONTEXT、FRAME_UNCERTAIN？ | 沒有這些出口 ＝ 逼 AI 硬猜 |
| **13** | **決策是否被 Prompt 提前鎖死** | Prompt 是否先下結論再問 AI？是否明顯偏向某策略的語氣？ | 問題中立，不暗示答案 |

---

## 五、系統健康層檢查清單（Meta / 維運）

防的是：**系統長期失控**。

| # | 檢查項 | 自檢問句 | 通過標準 |
|---|--------|----------|----------|
| **14** | **規則 TTL（過期機制）** | 每條規則什麼時候失效？由誰覆寫？ | 沒有 TTL 的規則遲早變垃圾，需有覆寫/版本機制 |
| **15** | **記憶壓力檢查** | 記憶是否影響行為？還是只是存著？ | 沒有影響行為的記憶 ＝ 噪音，需壓縮或歸檔 |
| **16** | **模型替換彈性** | 換模型後是否崩潰？Prompt 是否綁死某模型特性？ | 換模型不應崩潰；Prompt 避免模型專用語法 |
| **17** | **決策可視化能力** | 這次為什麼做這個決策？能否追溯三層原因？ | 工程師能回答；有 run_id/trace_id 與 audit_log |

---

## 鐵律（可寫進 SSOT）

> **規則的目的不是限制 AI，而是防止 AI 在錯誤方向上全速奔跑。**  
> 真正高階系統的結構是：**風控寫死、策略引導、決策自由**——不是三者混在一起。

---

## 版本與對照

- **對應 SSOT**：V8.0 架構定案文檔（V8.33 目標架構）
- **建立日期**：2026-01-26
- **審查報告**：`SSOT架構師級審查報告_V8.34_2026-01-26.md`
