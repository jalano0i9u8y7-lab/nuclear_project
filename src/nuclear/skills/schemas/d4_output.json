{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "D4_Worldview_Daily_Output",
    "description": "D-4 宏觀世界觀統整師每日輸出 (§10.7)",
    "type": "object",
    "required": [
        "date",
        "sub_world_reports",
        "d4_final"
    ],
    "properties": {
        "date": {
            "type": "string",
            "format": "date"
        },
        "sub_world_reports": {
            "type": "array",
            "minItems": 12,
            "maxItems": 12,
            "description": "12 份宏觀子世界報告",
            "items": {
                "type": "object",
                "required": [
                    "category",
                    "new_events",
                    "state_variables",
                    "historical_linkage",
                    "local_narrative",
                    "local_regime_tag"
                ],
                "properties": {
                    "category": {
                        "type": "string",
                        "enum": [
                            "Central_Bank",
                            "Econ_Data",
                            "Geopolitics",
                            "Stock_Index",
                            "Bond_Yield",
                            "Forex",
                            "Energy",
                            "Precious_Metals",
                            "Industrial_Metals",
                            "Crypto",
                            "Fear_Index",
                            "Institutional_Flow"
                        ]
                    },
                    "new_events": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "required": [
                                "news_id",
                                "source",
                                "impact_direction",
                                "confidence"
                            ],
                            "properties": {
                                "news_id": {
                                    "type": "string"
                                },
                                "source": {
                                    "type": "string"
                                },
                                "impact_direction": {
                                    "type": "string"
                                },
                                "confidence": {
                                    "type": "number",
                                    "minimum": 0,
                                    "maximum": 1
                                }
                            }
                        }
                    },
                    "state_variables": {
                        "type": "object"
                    },
                    "historical_linkage": {
                        "type": "object",
                        "required": [
                            "vs_t1",
                            "trend"
                        ],
                        "properties": {
                            "vs_t1": {
                                "type": "string"
                            },
                            "trend": {
                                "type": "string",
                                "enum": [
                                    "strengthening",
                                    "weakening",
                                    "unchanged",
                                    "regime_shift_candidate"
                                ]
                            }
                        }
                    },
                    "local_narrative": {
                        "type": "object",
                        "required": [
                            "dominant_narrative",
                            "anti_narrative_flag"
                        ],
                        "properties": {
                            "dominant_narrative": {
                                "type": "string"
                            },
                            "anti_narrative_flag": {
                                "type": "boolean"
                            }
                        }
                    },
                    "local_regime_tag": {
                        "type": "string",
                        "enum": [
                            "risk_on",
                            "risk_off",
                            "neutral",
                            "unstable"
                        ]
                    }
                }
            }
        },
        "d4_final": {
            "type": "object",
            "description": "D4-FINAL 總世界觀整合報告",
            "required": [
                "dominant_global_regime",
                "cross_world_conflicts",
                "regime_stability_score",
                "key_watch_signals"
            ],
            "properties": {
                "dominant_global_regime": {
                    "type": "string",
                    "enum": [
                        "Bull",
                        "Bear",
                        "Range",
                        "Crisis",
                        "Transition"
                    ]
                },
                "cross_world_conflicts": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "regime_stability_score": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                },
                "key_watch_signals": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "maxItems": 3
                }
            }
        }
    }
}