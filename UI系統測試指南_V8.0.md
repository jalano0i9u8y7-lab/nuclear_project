# 🎨 UI 系統測試指南 V8.0

**版本**: V8.0  
**日期**: 2025-01-15  
**狀態**: ✅ UI 已更新以支持 V8.0 新功能

---

## 📋 UI 功能檢查清單

### ✅ 已實現功能

1. **一鍵執行完整流程**
   - ✅ P0 → P0.7 → P1 → P2 → P2.5（V8.0 新增）→ P3 → P4
   - ✅ 自動跳過用戶確認
   - ✅ 執行狀態追蹤和顯示
   - ✅ 錯誤處理和日誌記錄

2. **策略操作面板**
   - ✅ 顯示本週待處理策略
   - ✅ 策略確認功能
   - ✅ 策略拒絕功能
   - ✅ 策略修改功能

3. **Human Signal 輸入**
   - ✅ 文字內容輸入
   - ✅ URL 輸入（自動抓取內容）
   - ✅ 標籤分類（市場/個股/宏觀/產業）
   - ✅ 相關股票代碼輸入
   - ✅ 重要性設定

4. **緊急通知**
   - ✅ DEFCON 警告顯示
   - ✅ P4.6 緊急撤退通知
   - ✅ **P5.4 警報顯示（V8.0 新增）**
   - ✅ 通知列表和排序

5. **系統狀態顯示**
   - ✅ 最後執行時間
   - ✅ DEFCON 等級
   - ✅ 待處理策略數量
   - ✅ 緊急通知數量
   - ✅ **P2.5 籌碼分析狀態（V8.0 新增）**
   - ✅ **P5.4 警報數量（V8.0 新增）**
   - ✅ **P5.9 泡沫階段（V8.0 新增）**
   - ✅ **當前 U（資金水位）（V8.0 新增）**

---

## 🚀 從 UI 進行測試

### 步驟 1：打開控制面板

1. **打開 Google Spreadsheet**
   - 打開您的 Nuclear Project Spreadsheet

2. **打開側邊欄**
   - 方法 1：點擊菜單「🚀 Nuclear Project」>「📊 打開控制面板」
   - 方法 2：執行函數 `showSidebar()`（在 GAS 編輯器中）

3. **確認側邊欄顯示**
   - 應該看到「Nuclear Project SSOT V7.1 控制面板」側邊欄
   - 包含以下按鈕：
     - 🚀 執行完整流程（P0 → P4）
     - 📋 查看本週策略
     - 📝 輸入 Human Signal
     - 🚨 緊急通知

---

### 步驟 2：測試一鍵執行完整流程

1. **點擊「執行完整流程（P0 → P4）」按鈕**

2. **觀察執行狀態**
   - 執行狀態會顯示在按鈕下方
   - 狀態會從「執行中，請稍候...」變為「執行完成！」或「執行失敗」

3. **查看執行結果**
   - 成功時會顯示各 Phase 的狀態：
     ```
     P0: COMPLETED
     P0_7: COMPLETED
     P1: COMPLETED
     P2: COMPLETED
     P2_5: SUBMITTED/SKIPPED
     P3: COMPLETED
     P4: COMPLETED
     ```

4. **檢查系統狀態**
   - 在「📊 系統狀態」區域查看：
     - 最後執行時間應該更新
     - P2.5 籌碼分析狀態（如果可用）
     - 當前 U（資金水位）

5. **查看執行記錄**
   - 在 GAS 編輯器中：View > Execution log
   - 查看詳細的執行日誌

---

### 步驟 3：測試策略操作

1. **點擊「查看本週策略」按鈕**

2. **查看策略列表**
   - 應該顯示本週生成的策略
   - 每個策略顯示：
     - 股票代碼（Ticker）
     - 策略類型（INCREASE/DECREASE/HOLD）
     - 操作（ADD_POSITION/REDUCE_POSITION 等）
     - 目標配置百分比
     - 信心度

3. **測試策略確認**
   - 點擊某個策略的「✅ 確認」按鈕
   - 確認對話框會出現
   - 點擊「確定」後，策略應該被標記為已確認

4. **測試策略拒絕**
   - 點擊某個策略的「❌ 拒絕」按鈕
   - 輸入拒絕原因
   - 策略應該被標記為已拒絕

5. **檢查追蹤記錄**
   - 策略確認/拒絕後，會保存到 `P5__WEEKLY_STRATEGY_TRACKING` 表格
   - 可以在 Spreadsheet 中查看該表格

---

### 步驟 4：測試 Human Signal 輸入

1. **點擊「輸入 Human Signal」按鈕**

2. **填寫表單**
   - **類型**：選擇「文章」、「新聞」、「分析」或「其他」
   - **標籤**：勾選相關標籤（市場/個股/宏觀/產業）
   - **內容**：輸入或貼上內容
   - **URL**（可選）：輸入 URL，系統會自動抓取內容
   - **相關股票代碼**（可選）：輸入股票代碼，用逗號分隔（例如：AAPL, TSLA, 2330）
   - **重要性**：選擇「低」、「中」、「高」或「緊急」

3. **提交**
   - 點擊「📤 提交到 P5 Daily」按鈕
   - 應該看到「提交成功！」訊息

4. **檢查處理結果**
   - Human Signal 會保存到 `HUMAN_SIGNAL` 表格
   - 如果設置了 `process_immediately: true`，會立即處理並整合到 `NEWS_ATOMS_DAILY`
   - 否則會在下次 P5 Daily 執行時處理

---

### 步驟 5：測試緊急通知

1. **點擊「緊急通知」按鈕**

2. **查看通知列表**
   - 應該顯示所有緊急通知，包括：
     - **DEFCON 警告**：如果 DEFCON >= 3
     - **P4.6 緊急撤退**：如果 P4.6 已觸發
     - **P5.4 警報**（V8.0 新增）：如果檢測到大幅度波動或黑天鵝新聞

3. **通知排序**
   - 通知按嚴重程度排序（CRITICAL > HIGH > MEDIUM > LOW）
   - 最緊急的通知會顯示在最上方

---

### 步驟 6：測試系統狀態顯示

1. **查看主頁面的「📊 系統狀態」區域**

2. **檢查各項狀態**
   - **最後執行時間**：應該顯示最近一次完整流程執行的時間
   - **DEFCON 等級**：顯示當前 DEFCON（1-5）
   - **待處理策略**：顯示本週待處理的策略數量
   - **緊急通知**：顯示緊急通知的數量
   - **P2.5 籌碼分析**（V8.0 新增）：顯示「✓ 可用」如果 P2.5 快照存在
   - **P5.4 警報**（V8.0 新增）：顯示警報數量（如果有）
   - **P5.9 泡沫階段**（V8.0 新增）：顯示當前泡沫階段（EARLY/MID/LATE/BURST）
   - **當前 U（資金水位）**（V8.0 新增）：顯示當前 U 值（例如：60%）

3. **狀態自動更新**
   - 每次打開側邊欄時，狀態會自動更新
   - 執行完整流程後，狀態會自動刷新

---

## 🔍 V8.0 新功能測試重點

### 1. P2.5 整合測試

**測試目標**：確認 P2.5（機構級籌碼分析）在 UI 中的顯示

**測試步驟**：
1. 執行完整流程（P0 → P4）
2. 檢查系統狀態中是否顯示「P2.5 籌碼分析：✓ 可用」
3. 如果顯示「✓ 可用」，表示 P2.5 快照已成功保存

**預期結果**：
- 如果 P2.5 執行成功，系統狀態應該顯示「P2.5 籌碼分析：✓ 可用」
- 如果 P2.5 跳過（缺少籌碼面數據），系統狀態不會顯示此項

---

### 2. P5.4 警報測試

**測試目標**：確認 P5.4（警報檢測）在 UI 中的顯示

**測試步驟**：
1. 執行 P5 Daily（或等待 P5 Daily 自動執行）
2. 如果檢測到大幅度波動或黑天鵝新聞，P5.4 會觸發警報
3. 檢查「緊急通知」頁面，應該看到 P5.4 警報
4. 檢查系統狀態，應該顯示「P5.4 警報：X 筆」

**預期結果**：
- 如果有警報，緊急通知頁面會顯示：
  - 「🚨 P5.4 警報：檢測到緊急情況」（如果觸發緊急撤退）
  - 「⚠️ P5.4 警報：檢測到大幅度波動」（如果有波動警報）
- 系統狀態會顯示警報數量

---

### 3. P5.9 泡沫監控測試

**測試目標**：確認 P5.9（泡沫監控系統）在 UI 中的顯示

**測試步驟**：
1. 執行 P5 Weekly（或等待 P5 Weekly 自動執行）
2. P5.9 會分析市場泡沫階段並調整 U 值
3. 檢查系統狀態，應該顯示：
   - 「P5.9 泡沫階段：EARLY/MID/LATE/BURST」
   - 「當前 U（資金水位）：XX%」

**預期結果**：
- 系統狀態會顯示當前泡沫階段
- 系統狀態會顯示當前 U 值（根據泡沫階段調整）

---

### 4. U 值動態調整測試

**測試目標**：確認 P5.9 調整的 U 值在 UI 中正確顯示

**測試步驟**：
1. 執行 P5 Weekly
2. P5.9 會根據泡沫階段調整 U 值：
   - EARLY：U 不變或微調
   - MID：U 降低 15%
   - LATE：U 降低 40%
   - BURST：U 降低 70%
3. 檢查系統狀態中的「當前 U（資金水位）」

**預期結果**：
- U 值應該根據泡沫階段動態調整
- 系統狀態會顯示調整後的 U 值

---

## 📊 UI 功能完整性檢查

### 核心功能

- [x] **一鍵執行完整流程**
  - [x] P0 執行
  - [x] P0.7 執行
  - [x] P1 執行
  - [x] P2 執行
  - [x] P2.5 執行（V8.0 新增，可選）
  - [x] P3 執行
  - [x] P4 執行
  - [x] 執行狀態顯示
  - [x] 錯誤處理

- [x] **策略操作**
  - [x] 策略列表顯示
  - [x] 策略確認
  - [x] 策略拒絕
  - [x] 策略修改（基礎）

- [x] **Human Signal 輸入**
  - [x] 文字輸入
  - [x] URL 輸入
  - [x] 標籤選擇
  - [x] 股票代碼輸入
  - [x] 重要性設定
  - [x] 提交處理

- [x] **緊急通知**
  - [x] DEFCON 通知
  - [x] P4.6 通知
  - [x] P5.4 通知（V8.0 新增）

- [x] **系統狀態**
  - [x] 最後執行時間
  - [x] DEFCON 等級
  - [x] 待處理策略數量
  - [x] 緊急通知數量
  - [x] P2.5 狀態（V8.0 新增）
  - [x] P5.4 警報數量（V8.0 新增）
  - [x] P5.9 泡沫階段（V8.0 新增）
  - [x] 當前 U 值（V8.0 新增）

---

## 🐛 常見問題

### 問題 1：側邊欄無法顯示

**錯誤**：`無法載入側邊欄。請確認 HTML 文件已正確上傳。`

**解決方案**：
1. 確認 `25_UI_SIDEBAR.html` 文件已上傳到 GAS
2. 在 GAS 編輯器中檢查文件是否存在
3. 如果文件不存在，執行 `clasp push` 重新上傳

### 問題 2：一鍵執行失敗

**錯誤**：`執行失敗：P0 執行失敗：...`

**解決方案**：
1. 檢查 API Keys 是否正確配置
2. 檢查 `M0__JOB_QUEUE` 表格是否存在
3. 查看執行記錄（View > Execution log）了解詳細錯誤

### 問題 3：策略列表為空

**錯誤**：`目前沒有待處理的策略`

**解決方案**：
- 這是正常的，如果還沒有執行 P5 Weekly，就不會有策略
- 先執行 P5 Weekly 生成策略，然後再查看

### 問題 4：系統狀態顯示不完整

**錯誤**：某些狀態項目沒有顯示

**解決方案**：
1. 確認相關 Phase 已執行（例如：P2.5 需要先執行 P2）
2. 檢查相關快照表格是否有數據
3. 刷新側邊欄（關閉後重新打開）

---

## 📝 測試記錄模板

測試完成後，請記錄：

```
## UI 測試記錄

**測試時間**：2025-01-15 XX:XX:XX
**測試版本**：V8.0
**測試人員**：XXX

### 功能測試結果

#### 一鍵執行完整流程
- [ ] 側邊欄可以正常打開
- [ ] 執行按鈕可以點擊
- [ ] 執行狀態正確顯示
- [ ] 所有 Phase 執行完成
- [ ] 執行結果正確顯示

#### 策略操作
- [ ] 策略列表可以正常顯示
- [ ] 策略確認功能正常
- [ ] 策略拒絕功能正常
- [ ] 追蹤記錄正確保存

#### Human Signal 輸入
- [ ] 表單可以正常填寫
- [ ] 文字輸入正常
- [ ] URL 輸入正常（如果測試）
- [ ] 提交功能正常
- [ ] 數據正確保存到表格

#### 緊急通知
- [ ] 通知列表可以正常顯示
- [ ] DEFCON 通知正常
- [ ] P4.6 通知正常
- [ ] P5.4 通知正常（V8.0）

#### 系統狀態
- [ ] 最後執行時間正確
- [ ] DEFCON 等級正確
- [ ] 待處理策略數量正確
- [ ] 緊急通知數量正確
- [ ] P2.5 狀態顯示（V8.0）
- [ ] P5.4 警報數量顯示（V8.0）
- [ ] P5.9 泡沫階段顯示（V8.0）
- [ ] 當前 U 值顯示（V8.0）

### V8.0 新功能測試

#### P2.5 整合
- [ ] P2.5 在執行流程中正確執行
- [ ] 系統狀態顯示 P2.5 可用狀態

#### P5.4 警報
- [ ] P5.4 警報正確檢測
- [ ] 警報在緊急通知中正確顯示
- [ ] 系統狀態顯示警報數量

#### P5.9 泡沫監控
- [ ] P5.9 正確分析泡沫階段
- [ ] 系統狀態顯示泡沫階段
- [ ] U 值根據泡沫階段正確調整

### 發現的問題

1. [問題描述]
2. [問題描述]

### 修復狀態

- [ ] 問題1已修復
- [ ] 問題2已修復
```

---

## 🎯 快速測試流程

### 最小測試（5 分鐘）

1. **打開側邊欄**：菜單 > 「📊 打開控制面板」
2. **查看系統狀態**：確認狀態區域正常顯示
3. **測試 Human Signal**：提交一個簡單的 Human Signal
4. **查看通知**：點擊「緊急通知」查看是否有通知

### 完整測試（15-30 分鐘）

1. **執行完整流程**：點擊「執行完整流程（P0 → P4）」
2. **等待執行完成**：約 10-20 分鐘
3. **檢查執行結果**：確認所有 Phase 都完成
4. **查看策略**：點擊「查看本週策略」
5. **測試策略操作**：確認或拒絕一個策略
6. **檢查系統狀態**：確認所有狀態項目都正確顯示
7. **測試 Human Signal**：提交一個 Human Signal
8. **查看通知**：檢查是否有緊急通知

---

## 📚 相關文檔

- `UI系統實現完成報告.md` - UI 系統實現詳情
- `UI系統設計方案.md` - UI 系統設計方案
- `V8.0架構定案文檔_SSOT.md` - V8.0 架構 SSOT

---

## ✅ UI 系統狀態

**✅ UI 系統已更新以支持 V8.0！**

所有核心功能完整，V8.0 新功能已整合：
- ✅ P2.5 狀態顯示
- ✅ P5.4 警報顯示
- ✅ P5.9 泡沫階段顯示
- ✅ U 值動態顯示

**準備就緒！可以開始從 UI 進行測試！** 🎉
